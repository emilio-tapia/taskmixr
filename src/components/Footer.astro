---
import DarkModeIcon from './icons/DarkModeIcon.astro';
import PaletteIcon from './icons/PaletteIcon.astro';
import ShareIcon from './icons/ShareIcon.astro';
import i18next, { t } from 'i18next';
import { LanguageSelector } from 'astro-i18next/components';
import GithubIcon from './icons/GithubIcon.astro';
import CodepenIcon from './icons/CodepenIcon.astro';
import TwitterIcon from './icons/TwitterIcon.astro';

const today = new Date();
const year = today.getFullYear();
---

<footer>
  <div class="background-head">
    <section class="boundaries" data-shadow_card>
      <div class="title-container">
        <h4>
          {t('site.footer.developed')}
          <a href="https://emilio-tapia.com/">Emilio Tapia</a>
        </h4>
      </div>
      <nav id="menu" aria-label="menu" class="navHeader">
        <ul>
          <li>
            <a href="https://github.com/emilio-tapia">
              <label>
                <GithubIcon />
              </label>
            </a>
          </li>
          <!-- <li>
            <a href="https://codepen.io/emilio_ta">
              <label>
                <CodepenIcon />
              </label>
            </a>
          </li> -->
          <!-- <li>
            <a href="https://twitter.com">
              <label>
                <TwitterIcon />
              </label>
            </a>
          </li> -->
        </ul>
      </nav>

      <div class="title-container">
        <h4>{t('site.footer.copyright')} {year}</h4>
      </div>
    </section>
  </div>
</footer>

<style lang="scss">
  @use '../styles/mixins' as m;
  footer {
    max-width: 1700px;
    width: 98%;
    padding-inline: 0rem;
    margin-inline: auto;

    label,
    summary {
      fill: var(--accent-light-3);
    }
  }

  [data-theme='purple'] {
    span {
      background: hsl(235 32% 52%);
    }
  }
  [data-theme='green'] {
    span {
      background: #5fbf79;
    }
  }
  [data-theme='red'] {
    span {
      background: hsl(0, 45%, 54%);
    }
  }

  .background-head {
    // background: linear-gradient(45deg,#9096dd,hsl(226 50% 20% / 1));
    position: relative;
    padding-inline: 2rem;
    padding-block-end: calc(1.5rem + 0.1vw);
  }

  .boundaries {
    background: transparent;
    padding-block: 0;

    border-radius: 1rem;
    padding-inline: 1rem;
    overflow: hidden;
    gap: 0.75rem;
    display: grid;

    // display: flex;
    // flex-direction: column;
    // gap: 1rem;
    // aspect-ratio: 16/ 3;
    // align-items: center;
    // justify-content: center;

    @include m.mediaBreakpoint(750) {
      @include m.gridMinMax(180, auto-fit);
      gap: 0;
      aspect-ratio: initial;
      background: var(--bg-light);
    padding-block: 0.5rem;
        }



    // max-width: 1700px;
    // width: 92%;
    margin-inline: auto;
    // display: flex;
    // justify-content: space-between;
    // align-items: center;

    // & > * {
    //   flex: 1;
    // }
    

    & > div {
      border-radius: 0.5rem;
      display: flex;
      justify-content: center;
      gap: 0;
      backdrop-filter: blur(10px);
      color: white;
      overflow: hidden;

      &:first-child {
        align-items: center;

        @include m.mediaBreakpoint(750) {
          align-items: flex-start;
        }
      }
      &:last-child {
        align-items: center;
        opacity: .5;
        zoom: .8;

        @include m.mediaBreakpoint(750) {
          align-items: flex-end;
          opacity: 1;
          zoom: 1;
        }
      }
    }
  }

  .navHeader {
    display: flex;
    position: relative;
    align-items: center;
    justify-content: center;
    flex-direction: row;
    height: fit-content;
    // box-shadow: 0 0.4rem 0.7rem -8px var(--dark-blue-101);
    // background: linear-gradient(
    //   45deg,
    //   var(--accent-light-5),
    //   var(--dark-blue-102)
    // );
    // background-size: 500%;
    // background-position-x: 27%;

    input[type='radio'],
    input[type='checkbox'] {
      height: 0px;
      width: 0px;
      display: none;

      &:is(:checked) + label {
        opacity: 1;
        // background: red; // .. TODO REMOVE
      }

      & + label {
        cursor: pointer;
      }
    }

    ul {
      display: inherit;
      flex-direction: row;
      gap: 1rem;
      align-items: center;
      color: var(--bg-light-2);

      & > li {
        a {
          display: flex;
        }

        &:hover {
          scale: 1.06;
        }
      }
    }

    a {
      & > * {
        cursor: inherit;
      }
    }

    details {
      cursor: pointer;
    }
  }

  .title-container {
    // display: flex;
    // align-items: flex-start;
    // justify-content: center;
    z-index: 3;
    position: relative;
    // color: #fff;
    // aspect-ratio: 16/2;
    flex-direction: column;
    line-height: 1.4;


    // @include m.mediaBreakpoint(750) {
    //   aspect-ratio: initial;
    //     }

    // background: linear-gradient(
    //   45deg,
    //   var(--accent-light-5),
    //   var(--dark-blue-102)
    // );
    // background-size: 500%;
    // background-position-x: 16%;

    h1 {
      color: var(--accent-gray);
      // font-size: clamp(1.5rem, 0.3rem + 4.8vw, 3rem);
      font-weight: 400;
      font-size: clamp(1.125rem, 0.8864rem + 1.0909vw, 1.5rem);
    }

    h4 {
      // OVERFLOW
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;

      // VISUAL
      color: var(--accent-gray);
      opacity: 0.9;
      font-weight: 400;
      text-transform: uppercase;
      font-size: clamp(
        calc(1.125rem - 0.5rem),
        0.8864rem + 1.0909vw,
        calc(1.5rem - 0.5rem)
      );

      a {
        appearance: none;
        color: var(--accent2-light-3);
        display: inline-block;
        


        @include m.mediaBreakpoint(750) {
          // color: var(--accent-light-5);
        }

        &:hover {
          text-decoration: underline;
        }
      }
    }
  }
</style>

<script>
  const themeButtons = document
    .getElementById('#themeList')
    ?.querySelectorAll('button');
  if (themeButtons) {
    for (let i = 0; i < themeButtons.length; i++) {
      const element = themeButtons[i];
      const color = element.dataset['theme'];
      element.addEventListener('click', (e) => {
        document.documentElement.dataset['themeGeneral'] = color;
      });
    }
  }

  const selectorid = document.querySelector('.langSelector');

  selectorid?.setAttribute('id', 'langSelectElement');

  const detailsElements = document.querySelectorAll('details');
  detailsElements.forEach((detail) =>
    detail.addEventListener('click', handleClickDetails)
  );

  function handleClickDetails(e: any) {
    for (let i = 0; i < detailsElements.length; i++) {
      const element = detailsElements[i];
      // console.log(element);
      if (e.currentTarget.id === element.id) {
        if (typeof e.target.value === 'string') {
          location = e.target.parentNode.getAttribute('value');
        }
      } else {
        if (element.open) element.open = false;
      }
    }
  }

  const darkModeCheck = document.getElementById('darkMode') as HTMLInputElement;
  darkModeCheck?.addEventListener('change', (e: any) => {
    let isDarkModeOn = e.currentTarget.checked;
    console.log(darkModeCheck.checked);

    if (isDarkModeOn) {
      document.documentElement.dataset['mode'] = 'dark';
      darkModeCheck.nextElementSibling!.innerHTML = `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" ><path d="M12 11.807A9.002 9.002 0 0 1 10.049 2a9.942 9.942 0 0 0-5.12 2.735c-3.905 3.905-3.905 10.237 0 14.142 3.906 3.906 10.237 3.905 14.143 0a9.946 9.946 0 0 0 2.735-5.119A9.003 9.003 0 0 1 12 11.807z"></path></svg>
    `;
    } else {
      document.documentElement.dataset['mode'] = 'light';
      darkModeCheck.nextElementSibling!.innerHTML = `
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" ><path
    d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z" ></path></svg>
    `;
    }
  });
</script>
